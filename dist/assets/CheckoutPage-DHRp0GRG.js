import{c as O,b as P,j as e,B as q,L as N,z as y,f as u}from"./index-BWUjk3th.js";import{u as B,r as g,L as E}from"./react-vendor-DP9M9pfQ.js";import{m as I,n as z,p as F,w as A,d as v,q as $,h as M}from"./firebase-vendor-BuohEl83.js";import{L as T,A as R}from"./lock-DZ5SaKZc.js";import{C as U}from"./credit-card-DcNPWSCI.js";/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=O("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),V=()=>{const{cartItems:o=[],cartTotal:w=0,clearCart:k}=P(),p=B();g.useEffect(()=>{(!o||o.length===0)&&p("/shop")},[o,p]);const[r,C]=g.useState({email:"",firstName:"",lastName:"",address:"",apartment:"",city:"",state:"",pincode:"",phone:""}),[n,j]=g.useState("ONLINE"),[i,m]=g.useState(!1),x=Number(w)||0,h=x>499?0:99,b=n==="COD"?49:0,f=x+h+b,l=a=>{const{name:t,value:c}=a.target;C(d=>({...d,[t]:c}))},D=async a=>{for(const t of a)try{const c=v(u,"products",t.id),d=await M(c);if(!d.exists())return{valid:!1,error:`Product "${t.name}" is no longer available.`};const s=d.data().stock||0;if(s<t.quantity)return{valid:!1,error:`Sorry, "${t.name}" is out of stock (Only ${s} left).`}}catch(c){return console.error("Stock check error:",c),{valid:!1,error:"System error checking stock. Please try again."}}return{valid:!0}},S=async a=>{a.preventDefault(),m(!0);try{const t=await D(o);if(!t.valid){m(!1),y.error(t.error);return}const c={items:o.map(s=>({id:s.id,name:s.name,quantity:s.quantity,price:s.price,variant:s.variant||"Standard",image:s.featuredImageUrl||s.image||""})),totalAmount:f,subtotal:x,shippingCost:h,codFee:b,shippingDetails:r,paymentMethod:n,status:"Pending",paymentStatus:n==="COD"?"Pending":"Paid",createdAt:I(),userEmail:r.email};await z(F(u,"orders"),c);const d=A(u);o.forEach(s=>{const L=v(u,"products",s.id);d.update(L,{stock:$(-s.quantity)})}),await d.commit(),m(!1),k(),y.success("Order Placed Successfully!"),p("/order-success")}catch(t){console.error("Checkout Error:",t),y.error("Failed to place order. Please try again."),m(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 font-body text-black",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 py-4 sticky top-0 z-50",children:e.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between",children:[e.jsx(E,{to:"/",className:"flex items-center gap-2",children:e.jsx(q,{className:"h-6 md:h-8 w-auto text-[#B08D55]"})}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] uppercase font-bold text-green-700 bg-green-50 px-3 py-1.5 rounded-full border border-green-200",children:[e.jsx(T,{size:12})," Secure Checkout"]})]})}),e.jsx("div",{className:"container mx-auto px-4 py-8 md:py-12",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-12 max-w-6xl mx-auto",children:[e.jsx("div",{className:"w-full lg:w-[60%]",children:e.jsxs("form",{id:"checkout-form",onSubmit:S,className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"bg-white p-6 md:p-8 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("h2",{className:"font-heading text-xl font-bold mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-black text-white rounded-full flex items-center justify-center text-xs",children:"1"}),"Contact Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"email",name:"email",required:!0,placeholder:"Email Address",value:r.email,onChange:l,className:"w-full p-3 bg-gray-50 border border-gray-200 rounded focus:border-black focus:bg-white outline-none transition-colors text-sm"}),e.jsxs("div",{className:"flex items-start gap-2 text-xs text-gray-500",children:[e.jsx(R,{size:14,className:"mt-0.5 text-[#B08D55]"}),"We'll send the order confirmation and tracking details here."]})]})]}),e.jsxs("div",{className:"bg-white p-6 md:p-8 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("h2",{className:"font-heading text-xl font-bold mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-black text-white rounded-full flex items-center justify-center text-xs",children:"2"}),"Shipping Address"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",name:"firstName",required:!0,placeholder:"First Name",className:"p-3 bg-gray-50 border border-gray-200 rounded focus:border-black outline-none text-sm",value:r.firstName,onChange:l}),e.jsx("input",{type:"text",name:"lastName",required:!0,placeholder:"Last Name",className:"p-3 bg-gray-50 border border-gray-200 rounded focus:border-black outline-none text-sm",value:r.lastName,onChange:l}),e.jsx("input",{type:"text",name:"address",required:!0,placeholder:"Address",className:"md:col-span-2 p-3 bg-gray-50 border border-gray-200 rounded focus:border-black outline-none text-sm",value:r.address,onChange:l}),e.jsx("input",{type:"text",name:"city",required:!0,placeholder:"City",className:"p-3 bg-gray-50 border border-gray-200 rounded focus:border-black outline-none text-sm",value:r.city,onChange:l}),e.jsx("input",{type:"text",name:"state",required:!0,placeholder:"State",className:"p-3 bg-gray-50 border border-gray-200 rounded focus:border-black outline-none text-sm",value:r.state,onChange:l}),e.jsx("input",{type:"text",name:"pincode",required:!0,placeholder:"Pincode",maxLength:6,className:"p-3 bg-gray-50 border border-gray-200 rounded focus:border-black outline-none text-sm",value:r.pincode,onChange:l}),e.jsx("input",{type:"tel",name:"phone",required:!0,placeholder:"Phone Number",maxLength:10,className:"p-3 bg-gray-50 border border-gray-200 rounded focus:border-black outline-none text-sm",value:r.phone,onChange:l})]})]}),e.jsxs("div",{className:"bg-white p-6 md:p-8 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("h2",{className:"font-heading text-xl font-bold mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-black text-white rounded-full flex items-center justify-center text-xs",children:"3"}),"Payment Method"]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("label",{className:`relative flex items-center gap-4 p-4 border rounded-lg cursor-pointer transition-all ${n==="ONLINE"?"border-[#B08D55] bg-orange-50/20":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"payment",value:"ONLINE",checked:n==="ONLINE",onChange:()=>j("ONLINE"),className:"accent-[#B08D55] w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-bold text-sm",children:"Pay Online"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Fast Dispatch"})]}),e.jsx(U,{className:"text-gray-400"})]}),e.jsxs("label",{className:`relative flex items-center gap-4 p-4 border rounded-lg cursor-pointer transition-all ${n==="COD"?"border-[#B08D55] bg-orange-50/20":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"payment",value:"COD",checked:n==="COD",onChange:()=>j("COD"),className:"accent-[#B08D55] w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-bold text-sm",children:"Cash on Delivery"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"₹49 Fee"})]}),e.jsx(W,{className:"text-gray-400"})]})]})]}),e.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 w-full p-4 bg-white border-t border-gray-200 z-40 shadow-xl",children:e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-black text-white py-4 rounded font-bold text-sm uppercase tracking-widest hover:bg-[#B08D55] transition-colors disabled:bg-gray-400 flex items-center justify-center gap-2",children:i?e.jsx(N,{className:"animate-spin",size:18}):`Pay ₹${f.toLocaleString()}`})})]})}),e.jsx("div",{className:"w-full lg:w-[40%]",children:e.jsxs("div",{className:"bg-white p-6 md:p-8 rounded-lg shadow-sm border border-gray-100 sticky top-24",children:[e.jsx("h2",{className:"font-heading text-xl font-bold mb-6",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 mb-6 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:o.map(a=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 overflow-hidden relative",children:[e.jsx("img",{src:a.featuredImageUrl||a.image,alt:a.name,className:"w-full h-full object-cover"}),e.jsx("span",{className:"absolute top-0 right-0 bg-gray-500 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-bl font-bold",children:a.quantity})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold text-black line-clamp-2",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.variant||"Standard"})]}),e.jsxs("div",{className:"text-sm font-bold",children:["₹",((a.price||0)*(a.quantity||1)).toLocaleString()]})]},a.id))}),e.jsxs("div",{className:"space-y-3 py-6 border-t border-gray-100",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["₹",x.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Shipping"}),h===0?e.jsx("span",{className:"text-green-600 font-bold",children:"Free"}):e.jsxs("span",{children:["₹",h]})]}),n==="COD"&&e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"COD Fee"}),e.jsxs("span",{children:["₹",b]})]})]}),e.jsxs("div",{className:"flex justify-between items-center py-6 border-t border-gray-100 mb-6",children:[e.jsx("span",{className:"font-heading text-xl font-bold",children:"Total"}),e.jsxs("span",{className:"font-heading text-2xl font-bold text-[#B08D55]",children:["₹",f.toLocaleString()]})]}),e.jsx("button",{form:"checkout-form",type:"submit",disabled:i,className:"hidden lg:flex w-full bg-black text-white py-4 rounded font-bold text-sm uppercase tracking-widest hover:bg-[#B08D55] transition-colors shadow-lg disabled:bg-gray-400 items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin",size:18})," Processing..."]}):"Place Order"})]})})]})})]})};export{V as default};
