import{c as I,d as D,j as e,e as z,v as T,T as F,r as _,m as P,X as S,L as $,s as H}from"./index-C2OvRd8y.js";import{r as n}from"./react-vendor-5iokPOny.js";import{o as B,m as J,x as W,d as A,l as C,j as Y,n as Q,D as V,q as X}from"./firebase-vendor-AFMmvn69.js";import{c as Z}from"./utils-D1JAXVn7.js";import{I as K}from"./AdminPage-C3JsetFZ.js";import"./package-Bszr9b7r.js";import"./ticket-BLqRqDGi.js";import"./log-out-DpAcT_ST.js";/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=I("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=I("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),me=()=>{const[g,h]=n.useState([]),[r,p]=n.useState(!0),[l,m]=n.useState(""),[u,c]=n.useState(!1),[y,v]=n.useState(null);n.useEffect(()=>B(J(D,"products"),o=>{const j=o.docs.map(x=>({id:x.id,...x.data()}));h(j),p(!1)}),[]);const N=()=>{const t=JSON.stringify(g,null,2),o=new Blob([t],{type:"application/json"}),j=URL.createObjectURL(o),x=document.createElement("a");x.href=j,x.download="products.json",document.body.appendChild(x),x.click(),document.body.removeChild(x)},b=async t=>{confirm("Delete this product permanently?")&&await W(A(D,"products",t))},f=(t=null)=>{v(t),c(!0)},w=n.useMemo(()=>g.filter(t=>{var o;return(o=t.name)==null?void 0:o.toLowerCase().includes(l.toLowerCase())}),[g,l]);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Product Manager"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage inventory, gallery, and details"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-bold text-sm",children:[e.jsx(ee,{size:16})," Download JSON"]}),e.jsxs("button",{onClick:()=>f(),className:"flex items-center gap-2 px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors font-bold text-sm",children:[e.jsx(z,{size:16})," Add Product"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search products...",value:l,onChange:t=>m(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-black"})]})}),e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 font-bold text-gray-500",children:"Image"}),e.jsx("th",{className:"p-4 font-bold text-gray-500",children:"Name"}),e.jsx("th",{className:"p-4 font-bold text-gray-500",children:"Stock"}),e.jsx("th",{className:"p-4 font-bold text-gray-500",children:"Price"}),e.jsx("th",{className:"p-4 font-bold text-gray-500 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:w.map(t=>e.jsxs("tr",{onClick:()=>f(t),className:"hover:bg-gray-50 cursor-pointer",children:[e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"w-10 h-10 rounded bg-gray-100 border overflow-hidden relative",children:t.imageUrls&&t.imageUrls.length>0?e.jsx("img",{src:t.imageUrls[0],alt:"",className:"w-full h-full object-cover"}):t.featuredImageUrl?e.jsx("img",{src:t.featuredImageUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300",children:e.jsx(K,{size:16})})})}),e.jsx("td",{className:"p-4 font-medium",children:t.name}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${t.stock>0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:t.stock})}),e.jsxs("td",{className:"p-4",children:["₹",t.price]}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:o=>{o.stopPropagation(),b(t.id)},className:"p-2 text-gray-400 hover:text-red-600 transition-colors",children:e.jsx(F,{size:16})})})]},t.id))})]})]}),e.jsx(te,{isOpen:u,onClose:()=>c(!1),product:y})]})},E=({label:g,existing:h,pending:r,onAdd:p,onRemoveExisting:l,onRemovePending:m})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-2",children:g}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[h.map((u,c)=>e.jsxs("div",{className:"aspect-square relative group rounded-lg overflow-hidden border border-gray-200",children:[e.jsx("img",{src:u,alt:"",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>l(c),className:"absolute top-1 right-1 bg-white/90 text-red-600 rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity shadow-sm",children:e.jsx(S,{size:12,strokeWidth:3})})]},`exist-${c}`)),r.map((u,c)=>e.jsxs("div",{className:"aspect-square relative group rounded-lg overflow-hidden border-2 border-green-500",children:[e.jsx("img",{src:u.preview,alt:"",className:"w-full h-full object-cover opacity-80"}),e.jsx("button",{type:"button",onClick:()=>m(c),className:"absolute top-1 right-1 bg-white/90 text-red-600 rounded-full p-1 shadow-sm",children:e.jsx(S,{size:12,strokeWidth:3})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500 text-white text-[9px] text-center py-1 uppercase font-bold",children:"New"})]},`new-${c}`)),e.jsxs("label",{className:"aspect-square bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:border-black hover:bg-gray-100 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:p,className:"hidden"}),e.jsx(z,{size:24,className:"text-gray-400 mb-1"}),e.jsx("span",{className:"text-[10px] font-bold uppercase text-gray-500",children:"Add"})]})]})]}),te=({isOpen:g,onClose:h,product:r})=>{const p=!r,[l,m]=n.useState({}),[u,c]=n.useState(!1),[y,v]=n.useState([]),[N,b]=n.useState([]),[f,w]=n.useState([]),[t,o]=n.useState([]);n.useEffect(()=>{if(g){m(r||{name:"",price:"",stock:10,category:"Rudraksha",description:""});let s=[];r!=null&&r.imageUrls&&Array.isArray(r.imageUrls)?s=r.imageUrls:r!=null&&r.featuredImageUrl&&(s=[r.featuredImageUrl]),v(s),b([]);let i=[];r!=null&&r.detailImageUrls&&Array.isArray(r.detailImageUrls)&&(i=r.detailImageUrls),w(i),o([])}},[g,r]);const j=s=>{if(s.target.files){const d=Array.from(s.target.files).map(a=>({file:a,preview:URL.createObjectURL(a)}));b(a=>[...a,...d])}},x=s=>v(i=>i.filter((d,a)=>a!==s)),R=s=>b(i=>i.filter((d,a)=>a!==s)),L=s=>{if(s.target.files){const d=Array.from(s.target.files).map(a=>({file:a,preview:URL.createObjectURL(a)}));o(a=>[...a,...d])}},M=s=>w(i=>i.filter((d,a)=>a!==s)),G=s=>o(i=>i.filter((d,a)=>a!==s)),U=async s=>Promise.all(s.map(async i=>{const d=await Z(i.file),a=Q(H,`products/${Date.now()}_${i.file.name}`);return await V(a,d),await X(a)})),q=async s=>{s.preventDefault(),c(!0);try{const i=await U(N),d=await U(t),a=[...y,...i],O=[...f,...d],k={...l,id:(r==null?void 0:r.id)||`prod_${Date.now()}`,price:Number(l.price),stock:Number(l.stock),imageUrls:a,featuredImageUrl:a.length>0?a[0]:"",detailImageUrls:O,updatedAt:C()};p&&(k.createdAt=C()),await Y(A(D,"products",k.id),k,{merge:!0}),h()}catch(i){console.error(i),alert("Failed to save product")}finally{c(!1)}};return e.jsx(_,{children:g&&e.jsxs(e.Fragment,{children:[e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:h,className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-[200]"}),e.jsxs(P.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},className:"fixed right-0 top-0 h-full w-full max-w-md bg-white shadow-2xl z-[210] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-lg",children:p?"New Product":"Edit Product"}),e.jsx("button",{onClick:h,children:e.jsx(S,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("form",{id:"product-form",onSubmit:q,className:"space-y-6",children:[e.jsx(E,{label:"Main Gallery Images",existing:y,pending:N,onAdd:j,onRemoveExisting:x,onRemovePending:R}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Name"}),e.jsx("input",{required:!0,className:"w-full p-3 border rounded-lg text-sm",value:l.name,onChange:s=>m({...l,name:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Price (₹)"}),e.jsx("input",{type:"number",required:!0,className:"w-full p-3 border rounded-lg text-sm",value:l.price,onChange:s=>m({...l,price:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Stock Qty"}),e.jsx("input",{type:"number",required:!0,className:"w-full p-3 border rounded-lg text-sm",value:l.stock,onChange:s=>m({...l,stock:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Category"}),e.jsxs("select",{className:"w-full p-3 border rounded-lg text-sm",value:l.category,onChange:s=>m({...l,category:s.target.value}),children:[e.jsx("option",{value:"Rudraksha",children:"Rudraksha"}),e.jsx("option",{value:"Gemstones",children:"Gemstones"}),e.jsx("option",{value:"Yantra",children:"Yantra"}),e.jsx("option",{value:"Mala",children:"Mala"}),e.jsx("option",{value:"Parad",children:"Parad"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Description Text"}),e.jsx("textarea",{rows:4,className:"w-full p-3 border rounded-lg text-sm",value:l.description,onChange:s=>m({...l,description:s.target.value})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{size:14,className:"text-gray-500"}),e.jsx("label",{className:"text-xs font-bold uppercase text-gray-500",children:"Description Images"})]}),e.jsx("p",{className:"text-[10px] text-gray-400 mb-3",children:"These images will appear below the description text (e.g. Benefits chart, Size guide)."}),e.jsx(E,{label:"",existing:f,pending:t,onAdd:L,onRemoveExisting:M,onRemovePending:G})]})]})}),e.jsx("div",{className:"p-4 border-t bg-gray-50",children:e.jsxs("button",{type:"submit",form:"product-form",disabled:u,className:"w-full py-3 bg-black text-white rounded-lg font-bold text-sm uppercase tracking-widest flex items-center justify-center gap-2",children:[u&&e.jsx($,{className:"animate-spin",size:16}),"Save Product"]})})]})]})})};export{me as ProductManager};
